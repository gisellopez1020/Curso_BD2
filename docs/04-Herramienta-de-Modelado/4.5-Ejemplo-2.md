# Ejemplo 2: Aplicaci贸n de Gesti贸n de Eventos Comunitarios

Imagina que est谩s desarrollando una plataforma de gesti贸n para eventos comunitarios en una ciudad. La plataforma est谩 destinada a permitir a los organizadores de eventos crear y gestionar actividades, y a los ciudadanos descubrir y participar en estos eventos.

Cada evento en la plataforma puede incluir una variedad de detalles como el nombre, la descripci贸n, ubicaci贸n del evento, el cual deber谩 incluir nombre del lugar, direcci贸n, comuna, barrio y c贸digo postal. Adicionalmente se deber谩 gestionar la fecha y hora de inicio, duraci贸n y un enlace para la inscripci贸n. Adem谩s, los eventos pueden tener uno o m谩s organizadores y pueden estar asociados a diferentes categor铆as, como arte, deportes, tecnolog铆a, y cultura. Los organizadores pueden ser tanto individuos como organizaciones, por tanto, es necesario gestionar un identificador 煤nico, nombre, tipo (persona u organizaci贸n), contacto, y una breve biograf铆a.

Los ciudadanos pueden participar en muchos eventos, pero para esto deber谩n ser mayores de edad y estar registrados en la plataforma mediante el nombre, sexo (masculino y femenino), edad, direcci贸n, tel茅fonos de contacto, fecha de inscripci贸n. Respecto a la inscripci贸n en cada uno de los ciudadanos se debe guardar historial de cada una de las inscripciones de los ciudadanos en los eventos mediante una referencia al evento, fecha, lugar y estado (asisti贸, no asisti贸). Mientras que en los eventos solo se deber谩 registrar la referencia a cada uno de los ciudadanos que participaron y la fecha de inscripci贸n. Por otro lado, los usuarios deben tener la capacidad de dejar comentarios y calificaciones sobre los eventos, lo que ayudar谩 a otros usuarios a tomar decisiones informadas sobre qu茅 eventos asistir.

Finalmente, es importante que la base de datos permita la desnormalizaci贸n de datos para mejorar el rendimiento en las consultas.

> **Nota:** _En el contexto de bases de datos NoSQL, la desnormalizaci贸n consiste en almacenar datos duplicados en varios lugares dentro de la base de datos. Esto implica agrupar informaci贸n relevante en un solo documento, lo cual mejora el rendimiento de las consultas al permitir que todos los datos relevantes se puedan obtener en una sola lectura._

## Soluci贸n Ejemplo 2

![Ejemplo 2](../../imgs/Ejemplo_2.png)

**Figura 25. Soluci贸n Ejemplo 2**

## Script Base de Datos Ejemplo 2

**_Colecci贸n Eventos_**

```
db.createCollection("Eventos", {
    "capped": false,
    "validator": {
        "$jsonSchema": {
            "bsonType": "object",
            "title": "Eventos",
            "properties": {
                "_id": {
                    "bsonType": "objectId"
                },
                "nombre": {
                    "bsonType": "string"
                },
                "descripcion": {
                    "bsonType": "string"
                },
                "ubicacion": {
                    "bsonType": "object",
                    "properties": {
                        "nombreLugar": {
                            "bsonType": "string"
                        },
                        "direccion": {
                            "bsonType": "string"
                        },
                        "comuna": {

                            "bsonType": "string"
                        },
                        "barrio": {
                            "bsonType": "string"
                        },
                        "codigoPostal": {
                            "bsonType": "int"
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "nombreLugar",
                        "direccion",
                        "comuna",
                        "barrio",
                        "codigoPostal"
                    ]
                },
                "fecha": {
                    "bsonType": "date"
                },
                "duracion": {
                    "bsonType": "int"
                },
                "hora": {
                    "bsonType": "date"
                },
                "URL": {
                    "bsonType": "string"
                },
                "categorias": {
                    "bsonType": "array",
                    "additionalItems": true,
                    "items": {
                        "bsonType": "string",
                        "enum": [
                            "arte",
                            "deporte",
                            "tecnologia",
                            "cultura"
                        ]
                    }
                },
                "inscripciones": {
                    "bsonType": "array",
                    "additionalItems": true,
                    "items": {
                        "bsonType": "object",
                        "properties": {
                            "ciudadanoId": {
                                "bsonType": "objectId"
                            },
                            "fechaInscripcion": {
                                "bsonType": "date"
                            }
                        },
                        "additionalProperties": false,
                        "required": [
                            "ciudadanoId",
                            "fechaInscripcion"
                        ]
                    }
                },
                "organizadores": {
                    "bsonType": "array",
                    "additionalItems": true,
                    "items": {
                        "bsonType": "object",
                        "properties": {
                            "organizadorId": {
                                "bsonType": "objectId"
                            },
                            "nombre": {
                                "bsonType": "string"
                            }
                        },
                        "additionalProperties": false
                    }
                }
            },
            "additionalProperties": true,
            "required": [
                "nombre",
                "descripcion",
                "ubicacion",
                "fecha",
                "duracion",
                "hora",
                "URL",
                "categorias",
                "inscripciones"
            ]
        }
    },
    "validationLevel": "moderate",
    "validationAction": "error"
});
```

**_Colecci贸n Ciudadanos_**

```
db.createCollection("Ciudadanos", {
    "capped": false,
    "validator": {
        "$jsonSchema": {
            "bsonType": "object",
            "title": "Ciudadanos",
            "properties": {
                "_id": {
                    "bsonType": "objectId"
                },
                "nombre": {
                    "bsonType": "string"
                },
                "sexo": {
                    "bsonType": "string",
                    "enum": [
                        "masculino",
                        "femenino"
                    ]
                },
                "edad": {
                    "bsonType": "number",
                    "minimum": 18
                },
                "direccion": {
                    "bsonType": "string"
                },
                "telefonos": {
                    "bsonType": "array",
                    "additionalItems": true,
                    "items": {
                        "bsonType": "int"
                    }
                },
                "fechaInscripcion": {
                    "bsonType": "date"
                },
                "inscripciones": {
                    "bsonType": "array",
                    "additionalItems": true,
                    "items": {
                        "bsonType": "object",
                        "properties": {
                            "eventoId": {
                                "bsonType": "objectId"
                            },
                            "fecha": {
                                "bsonType": "date"
                            },
                            "lugar": {
                                "bsonType": "string"
                            },
                            "estado": {
                                "bsonType": "string",
                                "enum": [
                                    "asistio",
                                    "noAsistio"
                                ]
                            }
                        },
                        "additionalProperties": false,
                        "required": [
                            "eventoId",
                            "fecha",
                            "lugar",
                            "estado"
                        ]
                    }
                }
            },
            "additionalProperties": true,
            "required": [
                "nombre",
                "sexo",
                "edad",
                "direccion",
                "telefonos",
                "fechaInscripcion",
                "inscripciones"
            ]
        }
    },
    "validationLevel": "moderate",
    "validationAction": "error"
});
```

**_Colecci贸n Organizadores_**

```
db.createCollection("Organizadores", {
    "capped": false,
    "validator": {
        "$jsonSchema": {
            "bsonType": "object",
            "title": "Organizadores",
            "properties": {
                "_id": {
                    "bsonType": "objectId"
                },
                "nombre": {
                    "bsonType": "string"
                },
                "tipo": {
                    "bsonType": "string",
                    "enum": [
                        "persona",
                        "organizacion"
                    ]
                },
                "contacto": {
                    "bsonType": "int"
                },
                "biografia": {
                    "bsonType": "string"
                }
            },
            "additionalProperties": true,
            "required": [
                "nombre",
                "tipo",
                "contacto",
                "biografia"
            ]
        }
    },
    "validationLevel": "moderate",
    "validationAction": "error"
});
```

## Conoce sobre el [Ecosistema de MongoDB ★](/docs/06-Ecosistema-MongoDB/6.1-Ecosistema-de-MongoDB.md)
